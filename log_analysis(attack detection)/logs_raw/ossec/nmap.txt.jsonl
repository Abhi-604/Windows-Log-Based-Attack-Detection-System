{"event": "OSSEC"}
{"event": "Copyright (C) 2009 Trend Micro Inc."}
{"event": "** Nmap correlation **"}
{"event": "Ossec can read nmap grepable output files to use as a"}
{"event": "correlation tool and also to alert based on host information"}
{"event": "changes. Follow the step by step below on how to configure"}
{"event": "ossec:"}
{"event": "1- Add the nmap output file on ossec.conf (generally"}
{"event": "at /var/ossec/etc/ossec.conf):"}
{"event": "<ossec_config>"}
{"event": "<localfile>"}
{"event": "<log_format>nmapg</log_format>"}
{"event": "<location>/var/log/nmap-out.log</location>"}
{"event": "</localfile>"}
{"event": "</ossec_config>"}
{"event": "2- If the file does not exist, touch it:"}
{"event": "ossec-test# touch /var/log/nmap-out.log"}
{"event": "3- Restart ossec:"}
{"event": "ossec-test# /var/ossec/bin/ossec-control restart"}
{"event": "4- Run your nmap scans (example scanning 192.168.2.0/24 network):"}
{"event": "ossec-test# nmap --append_output -sU -sT -oG /var/log/nmap-out.log 192.168.2.0-255"}
{"event": "*** Example of alert when a new host is found:"}
{"event": "** Alert 1152058913.238: mail"}
{"event": "2006 Jul 04 20:21:53 /var/log/nmap-out.log"}
{"event": "Rule: 15 (level 8) -> 'New host information added.'"}
{"event": "Src IP: (none)"}
{"event": "User: (none)"}
{"event": "Host: 192.168.2.10, open ports: 21(tcp) 22(tcp) 80(tcp) 113(tcp) 514(udp) 1514(udp) 4500(udp)"}
{"event": "*** Example of alert when a new a host information is changed:"}
{"event": "** Alert 1152058983.487: mail"}
{"event": "2006 Jul 04 20:23:03 /var/log/nmap-out.log"}
{"event": "Rule: 15 (level 8) -> 'Host information changed.'"}
{"event": "Src IP: (none)"}
{"event": "User: (none)"}
{"event": "Host: 192.168.2.1, open ports: 54(udp) 8080(tcp) 161(udp) 520(udp) 1025(udp) 1900(udp)"}
{"event": "Previously open ports: 53(udp) 80(tcp) 161(udp) 520(udp) 1025(udp) 1900(udp)"}
