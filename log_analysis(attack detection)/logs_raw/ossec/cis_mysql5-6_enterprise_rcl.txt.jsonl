{"event": "# OSSEC Linux Audit - (C) 2018"}
{"event": "#"}
{"event": "# Released under the same license as OSSEC."}
{"event": "# More details at the LICENSE file included with OSSEC or online"}
{"event": "# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE"}
{"event": "#"}
{"event": "# [Application name] [any or all] [reference]"}
{"event": "# type:<entry name>;"}
{"event": "#"}
{"event": "# Type can be:"}
{"event": "#             - f (for file or directory)"}
{"event": "#             - p (process running)"}
{"event": "#             - d (any file inside the directory)"}
{"event": "#"}
{"event": "# Additional values:"}
{"event": "# For the registry , use \"->\" to look for a specific entry and another"}
{"event": "# \"->\" to look for the value."}
{"event": "# For files, use \"->\" to look for a specific value in the file."}
{"event": "#"}
{"event": "# Values can be preceeded by: =: (for equal) - default"}
{"event": "#                             r: (for ossec regexes)"}
{"event": "#                             >: (for strcmp greater)"}
{"event": "#                             <: (for strcmp  lower)"}
{"event": "# Multiple patterns can be specified by using \" && \" between them."}
{"event": "# (All of them must match for it to return true)."}
{"event": "# CIS Checks for MYSQL"}
{"event": "# Based on Center for Internet Security Benchmark for MYSQL v1.1.0"}
{"event": "#"}
{"event": "$home_dirs=/usr2/home/*,/home/*,/home,/*/home/*,/*/home,/;"}
{"event": "$enviroment_files=/*/home/*/\\.bashrc,/*/home/*/\\.profile,/*/home/*/\\.bash_profile,/home/*/\\.bashrc,/home/*/\\.profile,/home/*/\\.bash_profile;"}
{"event": "$mysql-cnfs=/etc/mysql/my.cnf,/etc/mysql/mariadb.cnf,/etc/mysql/conf.d/*.cnf,/etc/mysql/mariadb.conf.d/*.cnf,~/.my.cnf;"}
{"event": "#"}
{"event": "#"}
{"event": "#1.3 Disable MySQL Command History"}
{"event": "[CIS - MySQL Configuration - 1.3: Disable MySQL Command History] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "d:$home_dirs -> ^.mysql_history$;"}
{"event": "#"}
{"event": "#"}
{"event": "#1.5 Disable Interactive Login"}
{"event": "[CIS - MySQL Configuration - 1.5: Disable Interactive Login] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:/etc/passwd -> r:^mysql && !r:\\.*/bin/false$|/sbin/nologin$;"}
{"event": "#"}
{"event": "#"}
{"event": "#1.6 Verify That 'MYSQL_PWD' Is Not In Use"}
{"event": "[CIS - MySQL Configuration - 1.6: 'MYSQL_PWD' Is in Use] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$enviroment_files -> r:\\.*MYSQL_PWD\\.*;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.3 Ensure 'allow-suspicious-udfs' Is Set to 'FALSE'"}
{"event": "[CIS - MySQL Configuration - 4.3: 'allow-suspicious-udfs' Is Set in my.cnf'] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:allow-suspicious-udfs\\.+true;"}
{"event": "f:$mysql-cnfs -> r:allow-suspicious-udfs\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.4 Ensure 'local_infile' Is Disabled"}
{"event": "[CIS - MySQL Configuration - 4.4: local_infile is not forbidden in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:local-infile\\s*=\\s*1;"}
{"event": "f:$mysql-cnfs -> r:local-infile\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.5 Ensure 'mysqld' Is Not Started with '--skip-grant-tables'"}
{"event": "[CIS - MySQL Configuration - 4.5: skip-grant-tables is set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:skip-grant-tables\\s*=\\s*true;"}
{"event": "f:$mysql-cnfs -> !r:skip-grant-tables\\s*=\\s*false;"}
{"event": "f:$mysql-cnfs -> r:skip-grant-tables\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.6 Ensure '--skip-symbolic-links' Is Enabled"}
{"event": "[CIS - MySQL Configuration - 4.6: skip_symbolic_links is not enabled in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:skip_symbolic_links\\s*=\\s*no;"}
{"event": "f:$mysql-cnfs -> !r:skip_symbolic_links\\s*=\\s*yes;"}
{"event": "f:$mysql-cnfs -> r:skip_symbolic_links\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.8 Ensure 'secure_file_priv' is not empty"}
{"event": "[CIS - MySQL Configuration - 4.8: Ensure 'secure_file_priv' is not empty] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> r:^# && r:secure_file_priv=\\s*\\S+\\s*;"}
{"event": "f:$mysql-cnfs -> !r:secure_file_priv=\\s*\\S+\\s*;"}
{"event": "f:$mysql-cnfs -> r:secure_file_priv\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#4.9 Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES'"}
{"event": "[CIS - MySQL Configuration - 4.9: strict_all_tables is not set at sql_mode section of my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:strict_all_tables\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.1 Ensure 'log_error' is not empty"}
{"event": "[CIS - MySQL Configuration - 6.1: log-error is not set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> r:^# && r:log_error\\s*=\\s*\\S+\\s*;"}
{"event": "f:$mysql-cnfs -> !r:log_error\\s*=\\s*\\S+\\s*;"}
{"event": "f:$mysql-cnfs -> r:log_error\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.2 Ensure Log Files are not Stored on a non-system partition"}
{"event": "[CIS - MySQL Configuration - 6.2: log files are maybe stored on systempartition] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/\\S*\\s*;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/var/\\S*\\s*;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/usr/\\S*\\s*;"}
{"event": "f:$mysql-cnfs -> r:log_bin\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.3 Ensure 'log_warning' is set to 2 at least"}
{"event": "[CIS - MySQL Configuration - 6.3: log warnings is set low] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*0;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*1;"}
{"event": "f:$mysql-cnfs -> !r:log_warnings\\s*=\\s*\\d+;"}
{"event": "f:$mysql-cnfs -> r:log_warnings\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.4 Ensure 'log_raw' is set to 'off'"}
{"event": "[CIS - MySQL Configuration - 6.4: log_raw is not set to off] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:log-raw\\s*=\\s*on;"}
{"event": "f:$mysql-cnfs -> r:log-raw\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.5 Ensure audit_log_connection_policy is not set to 'none'"}
{"event": "[CIS - MySQL Configuration - 6.5: audit_log_connection_policy is set to 'none' change it to all or erros] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r^# && r::audit_log_connection_policy\\s*=\\s*none;"}
{"event": "f:$mysql-cnfs -> r:audit_log_connection_policy\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.6 Ensure audit_log_exclude_account is set to Null"}
{"event": "[CIS - MySQL Configuration - 6.6:audit_log_exclude_accounts is not set to Null] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_exclude_accounts\\s*=\\s* && !r:null\\s*$;"}
{"event": "f:$mysql-cnfs -> r:audit_log_exclude_accounts\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.7 Ensure audit_log_include_accounts is set to Null"}
{"event": "[CIS - MySQL Configuration - 6.7:audit_log_include_accounts is not set to Null] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_include_accounts\\s*=\\s* && !r:null\\s*$;"}
{"event": "f:$mysql-cnfs -> r:audit_log_include_accounts\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.9 Ensure audit_log_policy is not set to all"}
{"event": "[CIS - MySQL Configuration - 6.9: audit_log_policy is not set to all] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*queries;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*none;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*logins;"}
{"event": "f:$mysql-cnfs -> r:audit_log_policy\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.10 Ensure audit_log_statement_policy is set to all"}
{"event": "[CIS - MySQL Configuration - 6.10: Ensure audit_log_statement_policy is set to all] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_statement_policy\\.+errors;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_statement_policy\\.+none;"}
{"event": "f:$mysql-cnfs -> r:audit_log_statement_policy\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.11 Ensure audit_log_strategy is set to synchronous or semisynchronous"}
{"event": "[CIS - MySQL Configuration - 6.11: Ensure audit_log_strategy is set to all] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_strategy\\.+asynchronous;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:audit_log_strategy\\.+performance;"}
{"event": "f:$mysql-cnfs -> !r:audit_log_strategy\\s*=\\s* && r:semisynchronous|synchronous;"}
{"event": "f:$mysql-cnfs -> r:audit_log_strategy\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#6.12 Make sure the audit plugin can't be unloaded"}
{"event": "[CIS - MySQL Configuration - 6.12: Audit plugin can be unloaded] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*on\\s*;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*off\\s*;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*force\\s*;"}
{"event": "f:$mysql-cnfs -> !r:^audit_log\\s*=\\s*force_plus_permanent\\s*;"}
{"event": "f:$mysql-cnfs -> r:^audit_log\\s$;"}
{"event": "#"}
{"event": "#"}
{"event": "#7.1 Ensure 'old_password' is not set to '1' or 'On'"}
{"event": "[CIS - MySQL Configuration - 7.1:Ensure 'old_passwords' is not set to '1' or 'on'] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*1;"}
{"event": "f:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*on;"}
{"event": "f:$mysql-cnfs -> !r:old_passwords\\s*=\\s*2;"}
{"event": "f:$mysql-cnfs -> r:old_passwords\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#7.2 Ensure 'secure_auth' is set to 'ON'"}
{"event": "[CIS - MySQL Configuration - 7.2: Ensure 'secure_auth' is set to 'ON'] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:secure_auth\\s*=\\s*off;"}
{"event": "f:$mysql-cnfs -> !r:secure_auth\\s*=\\s*on;"}
{"event": "f:$mysql-cnfs -> r:secure_auth\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#7.3 Ensure Passwords Are Not Stored in the Global Configuration"}
{"event": "[CIS - MySQL Configuration - 7.3: Passwords are stored in global configuration] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:^\\s*password\\.*;"}
{"event": "#"}
{"event": "#"}
{"event": "#7.4 Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER'"}
{"event": "[CIS - MySQL Configuration - 7.4: Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER'] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:no_auto_create_user\\s*$;"}
{"event": "f:$mysql-cnfs -> r:^# && r:\\s*no_auto_create_user\\s*$;"}
{"event": "#"}
{"event": "#"}
{"event": "#7.6 Ensure Password Policy is in Place"}
{"event": "[CIS - MySQL Configuration - 7.6: Ensure Password Policy is in Place ] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:plugin-load\\s*=\\s*validate_password.so\\s*$;"}
{"event": "f:$mysql-cnfs -> !r:validate-password\\s*=\\s*force_plus_permanent\\s*$;"}
{"event": "f:$mysql-cnfs -> !r:validate_password_length\\s*=\\s*14\\s$;"}
{"event": "f:$mysql-cnfs -> !r:validate_password_mixed_case_count\\s*=\\s*1\\s*$;"}
{"event": "f:$mysql-cnfs -> !r:validate_password_number_count\\s*=\\s*1\\s*$;"}
{"event": "f:$mysql-cnfs -> !r:validate_password_special_char_count\\s*=\\s*1;"}
{"event": "f:$mysql-cnfs -> !r:validate_password_policy\\s*=\\s*medium\\s*;"}
{"event": "#"}
{"event": "#"}
{"event": "#9.2 Ensure 'master_info_repository' is set to 'Table'"}
{"event": "[CIS - MySQL Configuration - 9.2: Ensure 'master_info_repositrory' is set to 'Table'] [any] [https://workbench.cisecurity.org/files/1310/download]"}
{"event": "f:$mysql-cnfs -> !r:^# && r:master_info_repository\\s*=\\s*file;"}
{"event": "f:$mysql-cnfs -> !r:master_info_repository\\s*=\\s*table;"}
{"event": "f:$mysql-cnfs -> r:master_info_repository\\s*$;"}
