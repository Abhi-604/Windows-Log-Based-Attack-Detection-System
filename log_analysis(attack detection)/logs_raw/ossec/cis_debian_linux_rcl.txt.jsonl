{"event": "# OSSEC Linux Audit - (C) 2018 OSSEC Project"}
{"event": "#"}
{"event": "# Released under the same license as OSSEC."}
{"event": "# More details at the LICENSE file included with OSSEC or online"}
{"event": "# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE"}
{"event": "#"}
{"event": "# [Application name] [any or all] [reference]"}
{"event": "# type:<entry name>;"}
{"event": "#"}
{"event": "# Type can be:"}
{"event": "#             - f (for file or directory)"}
{"event": "#             - p (process running)"}
{"event": "#             - d (any file inside the directory)"}
{"event": "#"}
{"event": "# Additional values:"}
{"event": "# For the registry , use \"->\" to look for a specific entry and another"}
{"event": "# \"->\" to look for the value."}
{"event": "# For files, use \"->\" to look for a specific value in the file."}
{"event": "#"}
{"event": "# Values can be preceded by: =: (for equal) - default"}
{"event": "#                             r: (for ossec regexes)"}
{"event": "#                             >: (for strcmp greater)"}
{"event": "#                             <: (for strcmp  lower)"}
{"event": "# Multiple patterns can be specified by using \" && \" between them."}
{"event": "# (All of them must match for it to return true)."}
{"event": "# CIS Checks for Debian/Ubuntu"}
{"event": "# Based on Center for Internet Security Benchmark for Debian Linux v1.0"}
{"event": "# Main one. Only valid for Debian/Ubuntu."}
{"event": "[CIS - Testing against the CIS Debian Linux Benchmark v1.0] [all required] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/debian_version;"}
{"event": "f:/proc/sys/kernel/ostype -> Linux;"}
{"event": "# Section 1.4 - Partition scheme."}
{"event": "[CIS - Debian Linux - 1.4 - Robust partition scheme - /tmp is not on its own partition {CIS: 1.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:/tmp;"}
{"event": "[CIS - Debian Linux - 1.4 - Robust partition scheme - /opt is not on its own partition {CIS: 1.4 Debian Linux}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/opt;"}
{"event": "f:/etc/fstab -> !r:/opt;"}
{"event": "[CIS - Debian Linux - 1.4 - Robust partition scheme - /var is not on its own partition {CIS: 1.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:/var;"}
{"event": "# Section 2.3 - SSH configuration"}
{"event": "[CIS - Debian Linux - 2.3 - SSH Configuration - Protocol version 1 enabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;"}
{"event": "[CIS - Debian Linux - 2.3 - SSH Configuration - IgnoreRHosts disabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;"}
{"event": "[CIS - Debian Linux - 2.3 - SSH Configuration - Empty passwords permitted {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;"}
{"event": "[CIS - Debian Linux - 2.3 - SSH Configuration - Host based authentication enabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;"}
{"event": "[CIS - Debian Linux - 2.3 - SSH Configuration - Root login allowed {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;"}
{"event": "# Section 2.4 Enable system accounting"}
{"event": "#[CIS - Debian Linux - 2.4 - System Accounting - Sysstat not installed {CIS: 2.4 Debian Linux}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "#f:!/etc/default/sysstat;"}
{"event": "#f:!/var/log/sysstat;"}
{"event": "#[CIS - Debian Linux - 2.4 - System Accounting - Sysstat not enabled {CIS: 2.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "#f:!/etc/default/sysstat;"}
{"event": "#f:/etc/default/sysstat -> !r:^# && r:ENABLED=\"false\";"}
{"event": "# Section 2.5 Install and run Bastille"}
{"event": "#[CIS - Debian Linux - 2.5 - System harderning - Bastille is not installed {CIS: 2.5 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "#f:!/etc/Bastille;"}
{"event": "# Section 2.6 Ensure sources.list Sanity"}
{"event": "[CIS - Debian Linux - 2.6 - Sources list sanity - Security updates not enabled {CIS: 2.6 Debian Linux} {PCI_DSS: 6.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:!/etc/apt/sources.list;"}
{"event": "f:!/etc/apt/sources.list -> !r:^# && r:http://security.debian|http://security.ubuntu;"}
{"event": "# Section 3 - Minimize inetd services"}
{"event": "[CIS - Debian Linux - 3.3 - Telnet enabled on inetd {CIS: 3.3 Debian Linux} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:telnet;"}
{"event": "[CIS - Debian Linux - 3.4 - FTP enabled on inetd {CIS: 3.4 Debian Linux} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:/ftp;"}
{"event": "[CIS - Debian Linux - 3.5 - rsh/rlogin/rcp enabled on inetd {CIS: 3.5 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:shell|login;"}
{"event": "[CIS - Debian Linux - 3.6 - tftpd enabled on inetd {CIS: 3.6 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:tftp;"}
{"event": "[CIS - Debian Linux - 3.7 - imap enabled on inetd {CIS: 3.7 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:imap;"}
{"event": "[CIS - Debian Linux - 3.8 - pop3 enabled on inetd {CIS: 3.8 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:pop;"}
{"event": "[CIS - Debian Linux - 3.9 - Ident enabled on inetd {CIS: 3.9 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inetd.conf -> !r:^# && r:ident;"}
{"event": "# Section 4 - Minimize boot services"}
{"event": "[CIS - Debian Linux - 4.1 - Disable inetd - Inetd enabled but no services running {CIS: 4.1 Debian Linux} {PCI_DSS: 2.2.2}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "p:inetd;"}
{"event": "f:!/etc/inetd.conf -> !r:^# && r:wait;"}
{"event": "[CIS - Debian Linux - 4.3 - GUI login enabled {CIS: 4.3 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/inittab -> !r:^# && r:id:5;"}
{"event": "[CIS - Debian Linux - 4.6 - Disable standard boot services - Samba Enabled {CIS: 4.6 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/samba;"}
{"event": "[CIS - Debian Linux - 4.7 - Disable standard boot services - NFS Enabled {CIS: 4.7 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/nfs-common;"}
{"event": "f:/etc/init.d/nfs-user-server;"}
{"event": "f:/etc/init.d/nfs-kernel-server;"}
{"event": "[CIS - Debian Linux - 4.9 - Disable standard boot services - NIS Enabled {CIS: 4.9 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/nis;"}
{"event": "[CIS - Debian Linux - 4.13 - Disable standard boot services - Web server Enabled {CIS: 4.13 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/apache;"}
{"event": "f:/etc/init.d/apache2;"}
{"event": "[CIS - Debian Linux - 4.15 - Disable standard boot services - DNS server Enabled {CIS: 4.15 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/bind;"}
{"event": "[CIS - Debian Linux - 4.16 - Disable standard boot services - MySQL server Enabled {CIS: 4.16 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/mysql;"}
{"event": "[CIS - Debian Linux - 4.16 - Disable standard boot services - PostgreSQL server Enabled {CIS: 4.16 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/postgresql;"}
{"event": "[CIS - Debian Linux - 4.17 - Disable standard boot services - Webmin Enabled {CIS: 4.17 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/webmin;"}
{"event": "[CIS - Debian Linux - 4.18 - Disable standard boot services - Squid Enabled {CIS: 4.18 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/init.d/squid;"}
{"event": "# Section 5 - Kernel tuning"}
{"event": "[CIS - Debian Linux - 5.1 - Network parameters - Source routing accepted {CIS: 5.1 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;"}
{"event": "[CIS - Debian Linux - 5.1 - Network parameters - ICMP broadcasts accepted {CIS: 5.1 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;"}
{"event": "[CIS - Debian Linux - 5.2 - Network parameters - IP Forwarding enabled {CIS: 5.2 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/proc/sys/net/ipv4/ip_forward -> 1;"}
{"event": "f:/proc/sys/net/ipv6/ip_forward -> 1;"}
{"event": "# Section 7 - Permissions"}
{"event": "[CIS - Debian Linux - 7.1 - Partition /var without 'nodev' set {CIS: 7.1 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;"}
{"event": "[CIS - Debian Linux - 7.1 - Partition /tmp without 'nodev' set {CIS: 7.1 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;"}
{"event": "[CIS - Debian Linux - 7.1 - Partition /opt without 'nodev' set {CIS: 7.1 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;"}
{"event": "[CIS - Debian Linux - 7.1 - Partition /home without 'nodev' set {CIS: 7.1 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev ;"}
{"event": "[CIS - Debian Linux - 7.2 - Removable partition /media without 'nodev' set {CIS: 7.2 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:/media && !r:nodev;"}
{"event": "[CIS - Debian Linux - 7.2 - Removable partition /media without 'nosuid' set {CIS: 7.2 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:/media && !r:nosuid;"}
{"event": "[CIS - Debian Linux - 7.3 - User-mounted removable partition /media {CIS: 7.3 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/fstab -> !r:^# && r:/media && r:user;"}
{"event": "# Section 8 - Access and authentication"}
{"event": "[CIS - Debian Linux - 8.8 - LILO Password not set {CIS: 8.8 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/lilo.conf -> !r:^# && !r:restricted;"}
{"event": "f:/etc/lilo.conf -> !r:^# && !r:password=;"}
{"event": "[CIS - Debian Linux - 8.8 - GRUB Password not set {CIS: 8.8 Debian Linux} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/boot/grub/menu.lst -> !r:^# && !r:password;"}
{"event": "[CIS - Debian Linux - 9.2 - Account with empty password present {CIS: 9.2 Debian Linux} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/shadow -> r:^\\w+::;"}
{"event": "[CIS - Debian Linux - 13.11 - Non-root account with uid 0 {CIS: 13.11 Debian Linux} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]"}
{"event": "f:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;"}
