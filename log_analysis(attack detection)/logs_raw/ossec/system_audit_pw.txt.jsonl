{"event": "# OSSEC Linux Audit - (C) 2018"}
{"event": "#"}
{"event": "# Released under the same license as OSSEC."}
{"event": "# More details at the LICENSE file included with OSSEC or online"}
{"event": "# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE"}
{"event": "#"}
{"event": "# [Application name] [any or all] [reference]"}
{"event": "# type:<entry name>;"}
{"event": "#"}
{"event": "# Type can be:"}
{"event": "#             - f (for file or directory)"}
{"event": "#             - p (process running)"}
{"event": "#             - d (any file inside the directory)"}
{"event": "#"}
{"event": "# Additional values:"}
{"event": "# For the registry , use \"->\" to look for a specific entry and another"}
{"event": "# \"->\" to look for the value."}
{"event": "# For files, use \"->\" to look for a specific value in the file."}
{"event": "#"}
{"event": "# Values can be preceeded by: =: (for equal) - default"}
{"event": "#                             r: (for ossec regexes)"}
{"event": "#                             >: (for strcmp greater)"}
{"event": "#                             <: (for strcmp  lower)"}
{"event": "# Multiple patterns can be specified by using \" && \" between them."}
{"event": "# (All of them must match for it to return true)."}
{"event": "#"}
{"event": "# Checks for Password Security on Linux Systems"}
{"event": "#"}
{"event": "#1 Set Default Algorithm for Password Encryption to SHA256 or SHA 512"}
{"event": "[Password Hardening - 1: Set Default Algorithm for Password Encryption to SHA256 or SHA 512] [any] [https://security.stackexchange.com/questions/77349/how-can-i-find-out-the-password-hashing-schemes-used-by-the-specific-unix-accoun, https://docs.oracle.com/cd/E26505_01/html/E27224/secsystask-42.html]"}
{"event": "f:/etc/security/policy.conf -> !r:^# && r:^CRYPT_DEFAULT=1|^CRYPT_DEFAULT=2|^CRYPT_DEFAULT=2a|^CRYPT_DEFAULT=2x|^CRYPT_DEFAULT=2y|^CRYPT_DEFAULT=md5|^CRYPT_DEFAULT=__unix__;"}
{"event": "f:/etc/security/policy.conf -> !r:^CRYPT_DEFAULT=\\d;"}
{"event": "f:/etc/login.defs -> !r:^# && r:^ENCRYPT_METHOD\\s+MD5|^ENCRYPT_METHOD\\s+DES;"}
{"event": "f:/etc/login.defs -> !r:^ENCRYPT_METHOD\\s+SHA512|^ENCRYPT_METHOD\\s+SHA256;"}
{"event": "f:/etc/pam.d/common-password -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;"}
{"event": "f:/etc/pam.d/common-password -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;"}
{"event": "f:/etc/pam.d/password-auth -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;"}
{"event": "f:/etc/pam.d/password-auth -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;"}
{"event": "f:/etc/pam.d/system-auth -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;"}
{"event": "f:/etc/pam.d/system-auth -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;"}
{"event": "f:/etc/pam.d/system-auth-ac -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;"}
{"event": "f:/etc/pam.d/system-auth-ac -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;"}
{"event": "#"}
{"event": "#"}
{"event": "#2 Passwords in /etc/shadow not hashed with SHA-256 or SHA-512"}
{"event": "[Password Hardening - 2: Not all Passwords in /etc/shadow are hashed with SHA-256 or SHA-512] [any] [https://linux-audit.com/password-security-with-linux-etc-shadow-file/, https://docs.oracle.com/cd/E19253-01/816-4557/concept-23/index.html]"}
{"event": "f:/etc/shadow -> !r:^# && !r:^\\w+:NP:\\d+:\\d*:\\d*:\\d*:\\d*:\\d*:\\d*$ && r:^\\w+:\\w\\.*:\\d+:\\d*:\\d*:\\d*:\\d*:\\d*:\\d*$;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$1\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$2\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$2a\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$2x\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$2y\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$md5\\$\\.+;"}
{"event": "f:/etc/shadow -> !r:^# && r:\\w+:\\$__unix__\\$\\.+;"}
{"event": "#"}
{"event": "#"}
{"event": "#3 Set Password Creation Requirement Parameters"}
{"event": "[Password Hardening - 3: Set Password Creation Requirement Parameters] [any] [https://linux-audit.com/configure-the-minimum-password-length-on-linux-systems/, https://workbench.cisecurity.org]"}
{"event": "f:/etc/pam.d/common-password -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;"}
{"event": "f:/etc/pam.d/common-password -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;"}
{"event": "f:/etc/pam.d/password-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;"}
{"event": "f:/etc/pam.d/system-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;"}
{"event": "f:/etc/pam.d/system-auth-ac -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;"}
{"event": "f:/etc/pam.d/system-auth-ac -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;"}
{"event": "f:/etc/pam.d/passwd -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass|^@include\\s+common-password;"}
{"event": "f:/etc/pam.d/passwd -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^@include\\s+common-password;"}
{"event": "f:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:minlen=\\d\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:minlen=\\d\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:minlen=\\d\\d+;"}
{"event": "f:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:minlen=\\d\\d+;"}
{"event": "f:/etc/security/pwquality.conf -> !r:^minlen=\\d\\d+;"}
{"event": "f:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;"}
{"event": "f:/etc/security/pwquality.conf -> !r:^dcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;"}
{"event": "f:/etc/security/pwquality.conf -> !r:^lcredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;"}
{"event": "f:/etc/security/pwquality.conf -> !r:^ocredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;"}
{"event": "f:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;"}
{"event": "f:/etc/security/pwquality.conf -> !r:^ucredit=\\p*\\d+;"}
{"event": "#"}
{"event": "#"}
{"event": "#4 Set default password expiration / aging parameters"}
{"event": "[Password Hardening - 4: Set password expiration / aging parameters] [any] [https://www.thegeekdiary.com/understanding-etclogin-defs-file, https://workbench.cisecurity.org/sections/26024/recommendations/63001]"}
{"event": "f:/etc/default/passwd -> !r:^MAXWEEKS=\\d\\d$;"}
{"event": "f:/etc/default/passwd -> !r:^MINWEEKS=\\d;"}
{"event": "f:/etc/default/passwd -> !r:^WARNWEEKS=\\d;"}
{"event": "f:/etc/login.defs -> !r:^PASS_MAX_DAYS\\s*\\t*\\d\\d$;"}
{"event": "f:/etc/login.defs -> !r:^PASS_MIN_DAYS\\s*\\t*\\d;"}
{"event": "f:/etc/login.defs -> !r:^PASS_WARN_AGE\\s*\\t*\\d;"}
